<html>
<head>
<title>PLSQL - Triggers</title>
	<link rel="shortcut icon" href="../../../images/icon.ico" type="image/ico">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.red-light_blue.min.css" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
<script defer src="../../../mdl/material.min.js"></script>
<style>
	.demo-card.mdl-card{width:950px;overflow:hidden;text-decoration:none;}
	.demo-card > .mdl-card__title{color:#fff;height:auto;background:url('images/oracle.png') center/cover;text-decoration:none;}
	.demo-card > .mdl-card__title a{color: inherit;text-decoration:none;}
	.demo-card > .mdl-card__menu{color:#fff;text-decoration:none;}	
	pre{font-family:inherit;font-size:15px}
</style>

</head>

<body>
		<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
		<header class="mdl-layout__header">
			<div class="mdl-layout__header-row">
				<span class="mdl-layout-title"><a href="../../../index.html"><img src="../../../images/icon.ico" width="50" height="50"></a></span>
				<div class="mdl-layout-spacer"></div>
				
				
				</div>
		</header>
		<div class="mdl-layout__drawer" style="margin-left:-38px;width:280px">
			<span class="mdl-layout-title"><img src="../../../images/banner.png" width="240" height="65"></span>
			<nav class="mdl-navigation" style="margin-left=-20px">
				<a class="mdl-navigation__link" href="../../../c.html"><img src="../../../images/logo/c.png" width="35" height="35">   C LANGUAGE</a>
				<a class="mdl-navigation__link" href="../../../c++.html"><img src="../../../images/logo/c++.png" width="35" height="35">    C++ PROGRAMING</a>
				<a class="mdl-navigation__link" href="../../../java.html"><img src="../../../images/logo/java.png" width="35" height="35">  JAVA</a>
				<a class="mdl-navigation__link" href="../../../oracle.html"><img src="../../../images/logo/oracle.png" width="30" height="30"> ORACLE</a>
				<a class="mdl-navigation__link" href="../../../python.html"><img src="../../../images/logo/python.png" width="30" height="30"> PYTHON</a>
				<a class="mdl-navigation__link" href="../../../webdev.html"><img src="../../../images/logo/webdev.png" width="35" height="35"> WEB DEVELOPMENT</a>
				<a class="mdl-navigation__link" href="../../../oracle_ebs/docs/00.html"><img src="../../../images/logo/o_ebs.png" width="35" height="35"> ORACLE_EBS</a>
			</nav>
		</div>
	
	<main >	
		<table class="mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp" style="margin-top:25px;margin-left:100px;margin-bottom:15px;widht:12px">
  		<thead> </thead>
  		<tbody >
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="01.html" style="text-decoration:none;color:inherit">	1. Blocks</a></td></tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="02.html" style="text-decoration:none;color:inherit">	2. Basics</a></td></tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="03.html" style="text-decoration:none;color:inherit">	3. Data Types</a></td></tr>
		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="04.html" style="text-decoration:none;color:inherit">	4. Control Statements</a></td></tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="05.html" style="text-decoration:none;color:inherit">	5. Loops</a></td> </tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="06.html" style="text-decoration:none;color:inherit">	6. Cursors</a></td> </tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="07.html" style="text-decoration:none;color:inherit"> 7. SubTopics in Cursors</a></td> </tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="08.html" style="text-decoration:none;color:inherit">	8. RefCursor</a></td></tr>
		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="09.html" style="text-decoration:none;color:inherit">	9. PreDefined Exceptions</a></td></tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="10.html" style="text-decoration:none;color:inherit">	10. UserDefined Exceptions</a></td></tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="11.html" style="text-decoration:none;color:inherit">	11. NonPredefined Exceptions</a></td> </tr>
		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="12.html" style="text-decoration:none;color:inherit">	12. Procedures</a></td> </tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="13.html" style="text-decoration:none;color:inherit">	13. Functions</a></td> </tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="14.html" style="text-decoration:none;color:inherit">	14. Packages</a></td></tr>
		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="15.html" style="text-decoration:none;color:inherit">	15. Misc</a></td></tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="16.html" style="text-decoration:none;color:inherit"><font size="3"><b>	16. Triggers</b></font></a></td> </tr>
    		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="17.html" style="text-decoration:none;color:inherit">			17. Collections</a></td> </tr>
  		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="18.html" style="text-decoration:none;color:inherit">			18. Bulk</a></td> </tr>
		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="19.html" style="text-decoration:none;color:inherit">			19. Misc</a></td> </tr>
  		<tr> <td class="mdl-data-table__cell--non-numeric"><a href="20.html" style="text-decoration:none;color:inherit">			20. Pragma Autonomous Transaction</a></td> </tr>
  		</tbody>
		</table>
	
		<table class="mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp" style="position:absolute;margin-top:-977px;margin-left:384px;width:955px;">
  		<thead> </thead>
  		<tbody    		<tr> <td class="mdl-data-table__cell--non-numeric"><center><font size="5"><b>16. Triggers</b></font></center></td></tr>
		</tbody>
		</table>
		
		<div class="page-content" style="position:absolute;margin-top:-930px;margin-left:370px;">
				<div class="mdl-grid">
					<div class="mdl-cell mdl-cell--10col" style="width:1500px;">
					<div class="mdl-card mdl-shadow--2dp demo-card" style="height:auto">
	<p><pre>
	<b>Triggers</b>
		=>Trigger is also same as stored procedure and also it will automatically invoked whenever ‘DML’ operation 
		performed against table or view
		=>There are two types of triggers
			•Statement level
			•Row level	
		=>In statement level trigger body is executed only for DML statements 
		=>In row level trigger , trigger body is executed for each and every DML operation
	Synt:
		Create or replace trigger		 trigger_name
		Before/after 			trigger event
		Insert/ update/ delete  	  on 	table_name
		{for each row}
		{where condition }
		{ declare }
		Varaibles, cursors declaration
		Begin
		-----------
		End;



	<b>Execution order in triggers:</b>
		=>Before statement level trigger
		=>Before row level trigger
		=>After row level
		=>After statement level

	<b>1. Statement level trigger</b>
		=>In this, trigger body is executed only once for each DML statement, that’s why generally 
		statement level triggers used to define type based condition and also used to implement auditing
		reports. These triggers does not contain new, old qualifiers.

	<b>Q: write a pl/sql statement level trigger on emp table not to perform DML operation in Saturday and Sunday?</b>
	Prgm:
		Create or replace trigger tr1
		Before
		Insert or update or delete on tt/fnd_user;
		Begin
			If to_char (sysdate, ’dy’) in (‘sat’, ’sun’);
			Then 
			Raise_application_error (-20123,’we can’t perform on sat and sun’);
			End if;
		End;

	<b>Q: write a pl/sql statement level trigger on emp table not to perform DML operations on last day of the month</b>
	Prgm;
		Create or replace trigger tr2
		Before
		Insert or update or delete on tt;
		begin
			If sysdate=last_date (sysdate) then
			Raise_application_error (-2011, ‘we can’t perform on last day of month’);
			End if;
		End;

      <b>TRIGGER EVENT:</b>
	=>If you want to define multiple condition on multiple tables then all data base systems uses trigger event.
	=>These are insert, update, deleting
	=>These are either used in statement level or row level

	<b>Q: write a pl/sql statement level trigger on emp table not to perform any DML </b>
	operations in any day using trigger event
	Progm:
		Create or replace trigger tr3
		Before
		Insert or update or delete on emp
		Begin
			If inserting then
			Raise_application_error (-21012, ‘we cant insert’); 
			elsIf updating then
			Raise_application_error (-21013, ‘we cant update’);
			elsIf delete then
			Raise_application_error (-21014, ‘we cant delete’);
			End if;
		End;

	Ex: create table test (msg varchar2(100));

		Create or replace trigger tr5 
		After
		Insert or update or delete on emp
		Declare
			A 	varchar(100);
		Begin
			If inserting then
			A:=’rows inserted’;
			elsIf updating then
			A:=’rows updated’;
			elsIf deleting then
			A:=’rows deleted’;
			End if;
			Insert into test values(a);
		End;
	
	<b>2.Row level trigger</b>
		=>In row level triggers, trigger body is executed for each row for DML operation, that’s the reason 
		we are using for each row clause in trigger specification and also data internally stored in 
		2 roll back segment qualifiers are OLD and NEW
		=>These qualifiers are used in either trigger specification or trigger body. When we are using these qualifiers 
		in trigger body we must use colon (:) prefix in the qualifiers
		=> Synt:  :old.column_name            (or)		:new.column_name
		=>When we are using these qualifiers in when clause we are not allowed to use colon infront of the qualifiers
		<img src="../../../images/table5.jpg">
	=>In before trigger, trigger body is executed before DML statements are effected into database
	=>In after trigger, trigger body is executed after DML statements are effected into database
	=>Generally we want to restrict the  invalid data entry ,always we are using before triggers, 
	where as if we are performing operations on the one table those operations are effecting on another table then we are using after trigger
	=>Whenever we are inserting values into new qualifiers we must use before trigger otherwise oracle server returns an error

	<b>Q: write a pl/sql row level trigger on emp table whenever user inserting data into emp table sal should be more than 5000?</b>
	Prgm:
		Create or replace trigger tr10
		Before 
		Insert on emp_t
		For each row
		Begin
		If :new.sal<5000 then
		Raise_application_error (-20123, ‘sal should be >5000’);
		End if;
		End;

	<b>Q: write a pl/sql row level trigger on emp, dept tables while implement on delete cascade 
		concept without using on delete cascade clause</b>
	Prgm:
		Create or replace trigger t11
		After  delete on dept
		For each row
		Begin
		Delete from emp where deptno=:old.deptno;
		End


	<b>Q: write a pl/sql row level trigger on dept table, whenever updating deptno’s in dept table 
		automatically those deptno’s modified in emp table</b>
	Prgm:
		Create or replace trigger t12
		After 
		Update on dept
		For each row
		Begin
		Update emp set deptno=:new.deptno where deptno=:old.deptno;
		End;

	<b>Q: write a pl/sql row level trigger on emp table by using below conditions
		1.Whenever user inserting data those values stored in another table
		2.Whenever user updating data those values stored in another table
		3.Whenever user deleting data those values stored in another table</b>
	Prgm:
		First we create 3 tables which are having the same structure of emp table
	
		Create or replace trigger t14
		After
		Insert or update or delete on emp
		For each row
		Begin
			If inserting then 
			Insert into e1 values (:new.empno,:new.ename);
			If updating then 
			Insert into e2 values (:old.empno,:new.ename);
			If deleting e3 then 
			Insert into e1 values (:old.empno,:new.ename);
		End;

	<b>Q: write a pl/sql trigger on emp table whenever user deleting records from emp table automatically display
	 remaining number of existing record number in bottom of delete statement?</b>
	Prgm:
		Create or replace trigger t15
		After
		Delete on emp
		Declare
			A	number (10);
		Begin
			Select count (*) into a from emp;
			Dbms_output.put_line (‘remaining records are:’||a);
		End;

	<b>MUTATING TRIGGER:</b>
		Create or replace trigger t15
		After
		Delete on emp
		For each row
		Declare
			A	numer (10);
		Begin
			Select count (*) into a from emp;
			Dbms_output.put_line (‘rmaining record are:’||a);
		End;

	=>In a row level trigger based on a table trigger body cannot read data from same table and also we cannot perform DML operations
	 on same table
	=>If we are trying to do this oracle will return an error table is mutating
	=>This error is called mutating error
	=>This table is called mutating table
	=>This trigger is called mutating trigger
	=>Mutating errors are not accured in statement level triggers because through these statement level triggers when we are performing 
	DML operations automatically data committed to data base
	=>Where as in row level triggers when we are performing transaction data is not committed and also again we are reading this data 
	from the same table then only mutating error is occurred
	=>To avoid this mutating error, we are using autonomous transaction in triggers.

	Create or replace trigger t15
	After
	Delete on emp
	For each row
	Declare
		Pragma autonomous_transaction;
		A	numer (10);
	Begin
		Select count (*) into a from emp;
		Dbms_output.put_line (‘rmaining record are:’||a);
	Commit;
	End;


	<b>DDL TRIGGERS</b>
		=>We can also create triggers on schema level, data base level. These types of triggers are called DDL triggers / system triggers.
		=>These are types of triggers are created by database administrator
	
	Synt:	create or replace trigger trigger_name
		Before/ after
		Create/ alter/rename/ drop
		On username.schema

	<b>Q: write a pl/sql trigger on schott schema not to drop emp table</b>
	Prgm:
		Create or replace trigger tr17
		Before
		Drop on apps.schema
		Begin
			If ora_dict_obj_name=’emp’ and 
			Ora_dict_obj_type=’TABLE’ then
			Raise_application_error (-20123, ‘we cannot drop table’);
			End if;
		End;
	
	</pre></p>		
					</div>	
					</div>				
				</div>
				</div>
		</main>
	

		<footer class="mdl-mini-footer" style="margin-top:4020px;" >
			<div class="mdl-mini-footer--left-section" style="margin-top:-15px;">
				<div class="mdl-logo"><b>Fallow us on</b></div>
				<ul class="mdl-mini-footer--link-list" style="margin-top:-15px;margin-left:105px;">
					<li><a href="https://facebook.com/c4c.ady" style="text-decoration:none;">	<img src="../../../images/facebook.png" 	width="35" height="35" onmouseover="this.src='../../../images/social/facebook.png'" onmouseout="this.src='../../../images/facebook.png'" style="position:relative;bottom:-12px"></a></li>
					<li><a href="https://twitter.com/c4c_ady" style="text-decoration:none;">   	<img src="../../../images/twitter.png" 	width="35" height="35" onmouseover="this.src='../../../images/social/twitter.png'" onmouseout="this.src='../../../images/twitter.png'" style="position:relative;bottom:-12px"></a>  </li>
					<li><a href="https://www.youtube.com/channel/UCDjj2kpaHyDbC9jpD1tEJ4Q" >	<img src="../../../images/youtube.png"  	width="35" height="35" onmouseover="this.src='../../../images/social/youtube.png'" onmouseout="this.src='../../../images/youtube.png'" style="position:relative;bottom:-12px"></a></li>
					<li><a href="https://instagram.com/c4c_ady" style="text-decoration:none;">	<img src="../../../images/instagram.png" width="35" height="35" onmouseover="this.src='../../../images/social/instagram.png'" onmouseout="this.src='../../../images/instagram.png'" style="position:relative;bottom:-12px"></a></li>
				</ul>
			</div>
		</footer>

	</div>


</body>
</html>